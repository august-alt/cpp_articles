[исходник](https://doc.qt.io/qt-6/qttestlib-tutorial3-example.html)

# Глава 3: Эмуляция событий GUI

Как эмулировать GUI

В Qt тестах есть некоторые механизмы для тестирования событий GUI. Вместо симуляции исходной системы событий, Qt посылает внутренние события. Это означает, что не бодет побочных эффектов на машине, на которой запущены тесты.

В этой главе мы напишем простой тест для графического интерфейса.

Написание теста графического интерфейса
***

В этот раз, давайте предположим, что вы хотите протестировать поведение нашего класса QLineEdit. Как и раньше, вам понадобится класс с тестовой функцией.

~~~
#include <QtWidgets>
#include <QTest>

class TestGui: public QObject
{
    Q_OBJECT

private slots:
    void testGui();


~~~ 

Различие только в том, что вам надо включить объявления классов графического интерфейса Qt в пространство имен QTest.

~~~
void TestGui::testGui()
{
    QLineEdit lineEdit;

    QTest::keyClicks(&lineEdit, "hello world");

    QCOMPARE(lineEdit.text(), QString("hello world"));
}
~~~

В реализации тестовой функции сначала мы создадим объект QLineEdit. Затем мы эмулируем ввод "hello word"  в строку, используя функцию QTest::keyClicks().

> Обратите внимание: Виджет также должен быть показан, чтобы правильно протестировать сочетания клавиш.

QTest::keyClicks() симулирет нажатие последовательности клавиш в виджете. Допольнительно можно указать модификатор клавиатуры, а также задержку (в миллисекундах) после каждого нажатия клавиши. Похожим образом можно использовать функции QTest::keyClick(), QTest::keyPress(), QTest::keyRelease(), QTest::mouseClick(), QTest::mouseDClick(), QTest::mouseMove(), QTest::mousePress() и QTest::mouseRelease() для имитации соответствующих событий GUI.

В конце, мы используем макрос QCOMPARE() для проверки полученного текста.

Как и раньше, для запуска теста в отдельном исполняемом файле, необходимо добавить две следующие строки:

~~~
QTEST_MAIN(TestGui)
#include "testgui.moc"
~~~

Макрос QTEST_MAIN() разворачивает в простой метод main(), который запускает все тесты, а так как объявления и реализация наших тестов в файле .cpp нам также необходимо включить сгенерированный файл moc для интроспекции Qt.
